import{L as Y,S as H,U as K,V as X,W as E,X as q,d as $,f as V,g as L,n as W,o as z,p as U,q as A,r as C}from"./chunk-K7W7JFVA.js";import{Da as y,Ea as N,Hb as s,Ib as r,Jb as D,Kb as I,Kc as j,Lb as R,Lc as B,Ma as f,Mb as x,Mc as S,Ob as p,Pb as u,Wb as M,Xb as d,Yb as g,dc as F,eb as l,fb as v,fc as T,la as k,qa as b,va as h,wa as P,wb as _,yb as c}from"./chunk-MQ344RA3.js";function oe(i,t){if(i&1){let a=x();s(0,"div")(1,"div",3)(2,"mat-icon"),d(3,"lock"),r(),s(4,"div",4),d(5),r()(),s(6,"button",5),p("click",function(){y(a);let e=u(2);return N(e.onCancel())}),d(7,"Cancel"),r()()}if(i&2){let a=u(2);l(5),g(a.timerDisplay)}}function se(i,t){if(i&1&&(s(0,"div")(1,"div",6)(2,"p"),d(3),r()()()),i&2){let a=u(2);l(3),g(a.encryption.decrypt(a.note.content))}}function re(i,t){if(i&1&&(s(0,"div"),_(1,oe,8,1,"div",2)(2,se,4,1,"div",2),r()),i&2){let a=u();l(),c("ngIf",!a.isTimerFinished),l(),c("ngIf",a.isTimerFinished)}}function ae(i,t){i&1&&(s(0,"p"),d(1,"Select a note to view its content."),r())}var J=(()=>{let t=class t{constructor(n){this.titleService=n,this.cancel=new f,this.timerFinished=new f,this.encryption=b(K),this.isTimerFinished=!1,this.timerDisplay="",this._note=null,this.worker=new Worker(new URL("worker-CPYKHWXW.js",import.meta.url),{type:"module"}),this.worker.onmessage=({data:e})=>this.handleWorkerMessage(e)}ngOnDestroy(){this.worker.terminate(),this.setTitle("TimeLock")}set note(n){if(n!==this._note)if(this._note=n,this.isTimerFinished=!1,this.timerFinished.emit(!1),this._note){let e=this._note.delayInMinutes*60*1e3;this.worker.postMessage({action:"start",countdownMilliseconds:e})}else this.worker.postMessage({action:"stop"})}get note(){return this._note}handleWorkerMessage(n){if(n.action==="tick"){let e=Math.floor(n.countdownMilliseconds/6e4),o=(n.countdownMilliseconds%6e4/1e3).toFixed(0);this.timerDisplay=`${e}:${Number(o)<10?"0":""}${o}`,this.setTitle(`${this.timerDisplay} | TimeLock`)}else n.action==="finished"&&(this.timerDisplay="",this.isTimerFinished=!0,this.timerFinished.emit(!0),this.setTitle("TimeLock"))}setTitle(n){this.titleService.setTitle(n)}onCancel(){this._note=null,this.timerDisplay="",this.cancel.emit(),this.worker.postMessage({action:"stop"}),this.setTitle("TimeLock")}};t.\u0275fac=function(e){return new(e||t)(v($))},t.\u0275cmp=h({type:t,selectors:[["app-note-display"]],inputs:{note:"note"},outputs:{cancel:"cancel",timerFinished:"timerFinished"},decls:3,vars:2,consts:[["noNote",""],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"timer-display"],[1,"countdown"],["mat-raised-button","","aria-label","Deselect current note button",3,"click"],[1,"note-content"]],template:function(e,o){if(e&1&&_(0,re,3,2,"div",1)(1,ae,2,0,"ng-template",null,0,T),e&2){let m=M(2);c("ngIf",o.note)("ngIfElse",m)}},dependencies:[S,z,C],styles:["[_nghost-%COMP%]{display:block}.timer-display[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}"]});let i=t;return i})();var ce=i=>({"no-items":i}),de=i=>({selected:i});function me(i,t){if(i&1){let a=x();s(0,"div",4),p("click",function(){let e=y(a).$implicit,o=u(2);return N(o.selectNote(e))}),s(1,"div",5)(2,"p"),d(3),r(),s(4,"div",6)(5,"mat-icon"),d(6,"lock"),r(),s(7,"span"),d(8),r()()()()}if(i&2){let a=t.$implicit,n=u(2);c("ngClass",F(3,de,n.selectedNote===a)),l(3),g(a.title),l(5),g(n.getFormattedDelay(a.delayInMinutes))}}function pe(i,t){if(i&1&&(I(0),_(1,me,9,5,"div",3),R()),i&2){let a=u();l(),c("ngForOf",a.notes)}}function fe(i,t){i&1&&(s(0,"div",7),d(1,"No notes"),r())}var Q=(()=>{let t=class t{constructor(){this.notes=[],this.selectedNote=null,this.noteSelected=new f}selectNote(n){this.noteSelected.emit(n)}getFormattedDelay(n){let e=Math.floor(n/60),o=n%60;return`${e?e+"h ":""}${o}m`}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h({type:t,selectors:[["app-sidebar"]],inputs:{notes:"notes",selectedNote:"selectedNote"},outputs:{noteSelected:"noteSelected"},decls:4,vars:5,consts:[["noNotes",""],[1,"sidebar",3,"ngClass"],[4,"ngIf","ngIfElse"],["class","sidebar-item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"sidebar-item",3,"click","ngClass"],[1,"note-header"],[1,"note-timer"],[1,"no-notes"]],template:function(e,o){if(e&1&&(s(0,"div",1),_(1,pe,2,1,"ng-container",2),r(),_(2,fe,2,0,"ng-template",null,0,T)),e&2){let m=M(3);c("ngClass",F(3,ce,o.notes.length===0)),l(),c("ngIf",o.notes.length>0)("ngIfElse",m)}},dependencies:[j,B,S,C],styles:[".sidebar[_ngcontent-%COMP%]{width:100%}.sidebar-item[_ngcontent-%COMP%]{padding:10px;cursor:pointer;border-bottom:1px solid #ccc;font-weight:700}.sidebar-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.sidebar-item.selected[_ngcontent-%COMP%]{background-color:#e0e0e0}.sidebar-item[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.sidebar-item[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.sidebar-item[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]   .note-timer[_ngcontent-%COMP%]{display:flex;align-items:baseline;font-size:.8em;color:#757575}.sidebar-item[_ngcontent-%COMP%]   .note-header[_ngcontent-%COMP%]   .note-timer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:1em}.no-notes[_ngcontent-%COMP%]{font-weight:700;text-align:center;padding:20px}"]});let i=t;return i})();var Z=(()=>{let t=class t{constructor(){this.create=new f,this.delete=new f,this.edit=new f,this.selectedNote=null,this.timerFinished=!1}createNote(){this.create.emit()}deleteNote(){this.delete.emit()}editNote(){this.edit.emit()}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=h({type:t,selectors:[["app-top-bar"]],inputs:{selectedNote:"selectedNote",timerFinished:"timerFinished"},outputs:{create:"create",delete:"delete",edit:"edit"},decls:10,vars:1,consts:[[1,"top-bar-left"],["mat-icon-button","","aria-label","Add New Note Button",3,"click"],["mat-icon-button","","aria-label","Delete Selected Note Button",3,"click","disabled"],[1,"divider"],[1,"top-bar-right"]],template:function(e,o){e&1&&(s(0,"mat-toolbar")(1,"div",0)(2,"button",1),p("click",function(){return o.createNote()}),s(3,"mat-icon"),d(4,"add"),r()(),s(5,"button",2),p("click",function(){return o.deleteNote()}),s(6,"mat-icon"),d(7,"delete"),r()()(),D(8,"div",3)(9,"div",4),r()),e&2&&(l(5),c("disabled",!o.selectedNote))},dependencies:[U,A,C],styles:[".mat-toolbar[_ngcontent-%COMP%]{padding:0!important;box-sizing:border-box}.mat-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.top-bar-left[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:calc(30% - .5px);padding-left:10px;padding-right:10px;box-sizing:border-box}.divider[_ngcontent-%COMP%]{border-left:1px solid #ccc;height:100%}.top-bar-right[_ngcontent-%COMP%]{display:flex;align-items:center;padding-left:10px;width:70%}.mat-form-field[_ngcontent-%COMP%]{width:100%}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}button[_ngcontent-%COMP%]{padding:0 10px}"]});let i=t;return i})();var ee=(()=>{let t=class t{constructor(n,e){this.dialog=n,this.router=e,this.notesFirebaseService=b(X),this.authService=b(W),this.notes=[],this.selectedNote=null,this.state={model:{},status:{isTimerFinished:!1}}}ngOnInit(){this.authService.getCurrentUserId().subscribe(n=>{n&&this.notesFirebaseService.getNotes(n).subscribe(e=>{this.notes=e})})}onNoteSelected(n){this.selectedNote=n}onCreateNote(){this.dialog.open(E,{width:"400px"}).afterClosed().subscribe(e=>{console.log(e?"Message created successfully":"Message creation canceled or failed")})}onEditNote(){this.selectedNote&&this.dialog.open(E,{width:"400px",data:this.selectedNote}).afterClosed().subscribe(e=>{console.log(e?"Message edited successfully":"Message edit canceled or failed")})}onDeleteNote(){this.selectedNote&&this.dialog.open(H,{width:"400px",data:{title:"Confirmation",message:"Are you sure you want to delete this item?",confirmButtonText:"Yes, delete",cancelButtonText:"Cancel"}}).afterClosed().subscribe(e=>{e&&this.notesFirebaseService.removeNote(this.selectedNote?.id).subscribe(()=>{this.selectedNote=null})})}onTimerFinished(n){this.state.status.isTimerFinished=n}onCancel(){this.selectedNote=null}};t.\u0275fac=function(e){return new(e||t)(v(Y),v(V))},t.\u0275cmp=h({type:t,selectors:[["ng-component"]],decls:5,vars:5,consts:[[1,"notes-container"],[3,"create","delete","edit","selectedNote","timerFinished"],[1,"content-container"],[3,"noteSelected","notes","selectedNote"],[3,"timerFinished","cancel","note"]],template:function(e,o){e&1&&(s(0,"div",0)(1,"app-top-bar",1),p("create",function(){return o.onCreateNote()})("delete",function(){return o.onDeleteNote()})("edit",function(){return o.onEditNote()}),r(),s(2,"div",2)(3,"app-sidebar",3),p("noteSelected",function(O){return o.onNoteSelected(O)}),r(),s(4,"app-note-display",4),p("timerFinished",function(O){return o.onTimerFinished(O)})("cancel",function(){return o.onCancel()}),r()()()),e&2&&(l(),c("selectedNote",o.selectedNote)("timerFinished",o.state.status.isTimerFinished),l(2),c("notes",o.notes)("selectedNote",o.selectedNote),l(),c("note",o.selectedNote))},dependencies:[Q,J,Z],styles:[".notes-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh}.content-container[_ngcontent-%COMP%]{display:flex;height:100%}app-sidebar[_ngcontent-%COMP%]{width:30%;border-right:1px solid #ccc;overflow-y:auto}app-note-display[_ngcontent-%COMP%]{width:70%;padding:20px}"]});let i=t;return i})();var te=[{path:"",component:ee}];var Qe=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=P({type:t}),t.\u0275inj=k({imports:[q,L.forChild(te)]});let i=t;return i})();export{Qe as NotesModule};
